/* For dumping the result */

select
    o.event_id,
    o.event_name,
    o.perf_id,
    -- IF(perf_name = 'vs オリックス', 'vs オリックス・バファローズ', perf_name) AS perf_name,
    o.perf_name,
    o.start_on,
    o.channel,
    o.order_no,
    DATE_FORMAT(o.ordered_at, '%Y-%m-%d %H:%I') AS ordered_at,
    -- IF(select_type = 'unknown', 'system', select_type) AS select_type,
    o.ua_type,
    o.order_status,
    o.payment_status,
    o.delivery_status,
    CASE o.payment_method WHEN 1 THEN 'マルチ決済' WHEN 2 THEN '楽天ペイ' WHEN 3 THEN 'セブン' WHEN 4 THEN '窓口' WHEN 5 THEN '無料' WHEN 6 THEN 'ファミマ' ELSE '不明' END AS payment,
    CASE o.delivery_method WHEN 1 THEN '配送' WHEN 2 THEN 'セブン' WHEN 3 THEN '窓口' WHEN 4 THEN 'QR認証' WHEN 5 THEN 'イベントゲート' WHEN 6 THEN' ファミマ' ELSE '不明' END AS delivery,
    o.fc_type,
    IF(o.fc_type ='', '', o.fc_id) AS fc_id,
    o.user_id,
    o.authz_identifier,
    o.total,
    o.fee,
    o.qty,
    o.point,
    o.email,
    -- item_serial,
    os.item_name,
    os.item_price,
    1 as item_qty,
    os.seat_name
from order201605 o
join order_seat201605 os using (order_id)
