<%page args="layout,form,h"/>
<table cellpadding="0" cellspacing="0" class="${layout.form_class_name}">
  <colgroup>
    <col style="width:180px;">
    <col style="width:310px;">
  </colgroup>
  <tbody>
    <tr>
      <th>新規／継続 <span class="red">*</span></th>
      <td>
        % for c in form.cont:
        ${c.label}${c()}
        % endfor
        <br>
        <small>お分かりの場合、下記に2012-13年の会員番号をご入力ください</small><br>
        ${form.old_id_number()}<small>(会員証記載のアルファベットを除いた半角数字)</small>
        ${h.error(['cont','old_id_number'])}
      </td>
    </tr>
    <tr>
      <th>会員種別 <span class="red">*</span></th>
      <td>
        <select id="member_type" name="member_type" class="">
          <option value="">選択してください</option>
          % for i, (k, val, s) in enumerate(form.member_type.iter_choices()):
          <option value="${k}" data-selection="${i}" data-permission="${" ".join(form.permission_dict.get(k))}" ${"selected=selected" if s else ''}>${val}</option>
          % endfor
        </select>
        ${layout.form_html_extra_info}
        ${h.error('member_type')}
      </td>
    </tr>
    <tr>
      <th>クラブブルズ限定デザインTシャツ<br>【レッド会員限定特典】</th>
      <td>
        <span class="form-field-message">
          レッド会員にお申込の方のみ入力下さい <br/>
          ※サイズをお選びいただけます<br/>
        </span>
        サイズ${form.extra.t_shirts_size(id='t_shirts_size',disabled="disabled", class_=" ".join(["has-permission", layout.symbols.t_shirts_size]))}
        ${h.error(['extra.t_shirts_size'])}
      </td>
    </tr>
    <tr>
      <th>レプリカユニフォーム<br>【シルバー会員限定特典】</th>
      <td>
        <span class="form-field-message">
          シルバー会員にお申込の方のみ入力下さい<br/>
          ※サイズをお選びいただけます<br/>
        </span>
        サイズ${form.extra.replica_uniform_size(id='replica_uniform_size',disabled="disabled", class_=" ".join(["has-permission", layout.symbols.replica_uniform]))}
        ${h.error(['extra.replica_uniform_size'])}
      </td>
    </tr>
    <tr>
      <th>オーセンティックユニフォーム<br/>【ゴールド会員限定特典】<br/>【シルバー会員半額購入特典】<br/><br/></th>
      <td>
        <span class="form-field-message">
          ゴールド会員にお申込の方orシルバー会員で半額購入希望の方のみ入力下さい<br/>
          ※お好きな背番号・名前・サイズ・色(赤または白)をお選びいただけます<br/>
        </span>
        背番号${form.extra.authentic_uniform_no(id='authentic_uniform_no',disabled="disabled",size=2, class_=" ".join(["has-permission", layout.symbols.authentic_uniform]))}<small>(数字2桁)</small>
        お名前${form.extra.authentic_uniform_name(id='authentic_uniform_name',disabled="disabled", size=16, class_=" ".join(["has-permission", layout.symbols.authentic_uniform]))}<small>(アルファベット大文字のみ)</small> <br/>
        サイズ${form.extra.authentic_uniform_size(id='authentic_uniform_size',disabled="disabled", class_=" ".join(["has-permission", layout.symbols.authentic_uniform]))}
        色${form.extra.authentic_uniform_color(id='authentic_uniform_color',disabled="disabled", class_=" ".join(["has-permission", layout.symbols.authentic_uniform]))}
        ${h.error(['extra.authentic_uniform_no','extra.authentic_uniform_name','extra.authentic_uniform_size','extra.authentic_uniform_color'])}
      </td>
    </tr>
    <tr>
      <th>
        氏名 <span class="red">*</span>
      </th>
      <td>
        姓${form.last_name(size="40")}<small>（全角）</small><br>
        名${form.first_name(size="40")}<small>（全角）</small>
        ${h.error(['last_name','first_name'])}
      </td>
    </tr>
    <tr>
      <th>
        氏名（フリガナ） <span class="red">*</span>
      </th>
      <td>
        セイ${form.last_name_kana(size="40")}<small>（全角カナ）</small><br>
        メイ${form.first_name_kana(size="40")}<small>（全角カナ）</small>
        ${h.error(['last_name_kana','first_name_kana'])}
      </td>
    </tr>
    <tr>
      <th>
        誕生日 <span class="red">*</span>
      </th>
      <td>
        ${form.year}年${form.month}月${form.day}日
        ${h.error(['year','month', 'day'])}
      </td>
    </tr>
    <tr>
      <th>
        性別 <span class="red">*</span>
      </th>
      <td>
        % for c in form.sex:
        ${c.label}${c()}
        % endfor
        ${h.error('sex')}
      </td>
    </tr>
    <tr>
      <th>
        郵便番号 <span class="red">*</span>
      </th>
      <td>
        ${form.zipcode1(size="6", maxlength="3")}-${form.zipcode2(size="6", maxlength="4")}<span><small>（半角英数）</small></span>
        ${h.error(['zipcode1', 'zipcode2'])}
      </td>
    </tr>
    <tr>
      <th>
        住所 <span class="red">*</span>
      </th>
      <td>
        <!-- TODO: 選択 -->
        都道府県
        ${form.prefecture()}<br>
        市区町村
        ${form.city(size=25)}
        （例：盛岡市） <br>
        町名番地 ${form.address1(size=25)}
        （例：大沢川原99丁目99番99号）
        <br>
        建物名等 ${form.address2(size=25)}
        （例：XXビル253号）
        ${h.error(['prefecture', 'city', 'address1', 'address2'])}
      </td>
    </tr>
    <tr>
      <th rowspan="2">
        電話番号 <span class="red">*</span><br />
        <span class="red">（携帯・自宅のどちらか必須）</span>
      </th>
      <td>
        (携帯) ${form.tel_1(size=12)}<span><small>${layout.dont_include_hyphen_message}</small></span>
        ${h.error(['tel_1'])}
      </td>
    </tr>
    <tr>
      <td>
        (自宅) ${form.tel_2(size=12)}<span><small>${layout.dont_include_hyphen_message}</small></span>
        ${h.error(['tel_2'])}
      </td>
    </tr>
    <tr>
      <th>
        メールアドレス <span class="red">*</span>
      </th>
      <td>
        ${form.email_1}<span><small>（半角英数）（PC・携帯のどちらも入力可）</small></span>
        ${h.error('email_1')}
      </td>
    </tr>
    <tr>
      <th>
        メールアドレス（確認用）<span class="red">*</span>
      </th>
      <td>
        ${form.email_1_confirm}
        ${h.error('email_1_confirm')}
      </td>
    </tr>
    <tr>
      <th>
        ${form.extra.mail_permission.label}
      </th>
      <td>
        ${form.extra.mail_permission}
        ${h.error('extra.mail_permission')}
      </td>
    </tr>
    <tr>
      <th>
        ${form.extra.form.publicity.label}
      </th>
      <td>
        ${form.extra.form.publicity} 
        ${h.error('extra.publicity')}
      </td>
    </tr>
    <tr>
      <th>
        保護者氏名 <br><span class="form-field-message">
          ※お申込者が18歳未満の場合は必須<br/>
          18歳以上の方は入力不要<br/>
        </span>
      </th>
      <td>
        姓${form.extra.parent_last_name(size="40")}<small>（全角）</small><br>
        名${form.extra.parent_first_name(size="40")}<small>（全角）</small>
        ${h.error(['extra.parent_last_name','extra.parent_first_name'])}
      </td>
    </tr>
    <tr>
      <th>
        保護者氏名 <br><span class="form-field-message">
          ※お申込者が18歳未満の場合は必須<br/>
          18歳以上の方は入力不要<br/>
        </span>
      </th>
      <td>
        セイ${form.extra.parent_last_name_kana(size="40")}<small>（全角カナ）</small><br>
        メイ${form.extra.parent_first_name_kana(size="40")}<small>（全角カナ）</small>
        ${h.error(['extra.parent_last_name_kana','extra.parent_first_name_kana'])}
      </td>
    </tr>
    <tr>
      <th>続柄 <br/>
        <span class="form-field-message">
          ※お申込者が18歳未満の場合は必須<br/>
          18歳以上の方は入力不要<br/>
        </span>
      </th>
      <td>
        続柄${form.extra.relationship(id='relationship')} 例：父、母、など 
        ${h.error(['extra.relationship'])}　
      </td>
    </tr>
    <tr>
      <td colspan="2" style="text-align:center">
        <div class="textRight red" style="font-size:12px;">*は入力必須項目です。電話番号は携帯・自宅のどちらか一方で構いません。</div>
        <input type="submit" value="次に進む" class="submit" style="width:400px;height:50px;">
      </td>
    </tr>
  </tbody>
</table>

<script type="text/javascript">
$('#member_type').on("change", function(e) {
  $("input.has-permission,select.has-permission").attr("disabled","disabled");
  var $this = $(e.currentTarget)
  var $selected_child = $this.find('option:selected');
  if($selected_child.length >= 1){
    var ks = $selected_child.attr("data-permission").split(" ");
    if(ks.length >= 1 && ks[0] != ""){
      for(var i=0,j=ks.length; i<j; i++){
        var $e = $("."+ks[i]);
        if($e.attr("disabled")){$e.removeAttr("disabled");}
      }
    }
  }
});
$("#member_type").change();
</script>
