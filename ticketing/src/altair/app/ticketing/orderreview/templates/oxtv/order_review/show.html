<%inherit file="../commons/layout.html" />
<h1>購入履歴確認 検索結果</h1>
<style type="text/css">
.purchasedContents .performance table {
      border: 2px #efefef solid;
      border-collapse: collapse;
      width: 620px;
      background: #fff;
}

.purchasedContents .performance {
      border: none;
      text-align: left;
}

.purchasedContents .performance .basic-info {
    margin-bottom: 1em;
}

.purchasedContents .performance .basic-info span.event-title {
    display: block;
    font-size: 16px;
    border-bottom: 1px solid #ccc;
    padding-bottom: 4px;
    margin-bottom: 4px;
}

.purchasedContents .performance .basic-info span.performance-name {
    display: block;
    font-size: 14px;
    margin-bottom: .5em;
}

.purchasedContents .performance .basic-info span.performance-datetime {
    font-size: 14px;
}

.purchasedContents .performance .basic-info span.venue-name {
    font-size: 14px;
}

.purchasedContents .performance table {
    border: 2px #efefef solid;
    border-collapse: collapse;
    width: 620px;
    background: #fff;
    margin: 0 auto;
}

table.purchasedContents {
    width: 100%;
}

table.purchasedContents thead th {
    font-size: 16px;
    text-align: left;
}

table.purchasedContents tbody tr {
    border-top: 1px #efefef solid;
}

table.purchasedContents tbody td,
table.purchasedContents tbody th {
    text-align: left;
    padding: 3px 3px;
    border-bottom: 1px solid #ccc;
}

table.purchasedContents tbody td ul {
    padding: 0 0 0 20px;
}

table.purchasedContents tbody td ul li {
    margin-top: 3px;
}

table.purchasedContents tfoot td {
    border-top: 1px #ccc solid;
    font-size: 16px;
    text-align: left;
    padding: 10px 18px;
}

table.purchasedContents tfoot td .paymentCoupon {
    -moz-box-shadow:inset 0px 1px 0px 0px #d67c75;
    -webkit-box-shadow:inset 0px 1px 0px 0px #d67c75;
    box-shadow:inset 0px 1px 0px 0px #d67c75;
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ad271d), color-stop(1, #661d16) );
    background:-moz-linear-gradient( center top, #ad271d 5%, #661d16 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ad271d', endColorstr='#661d16');
    background-color:#ad271d;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    border-radius:6px;
    border:1px solid #16499b;
    display:inline-block;
    color:#ffffff;
    font-family:arial;
    font-size:15px;
    font-weight:bold;
    padding:6px 60px;
    text-decoration:none;
    text-shadow:1px 1px 0px #98231a;
}

table.purchasedContents tfoot td .paymentCoupon:hover {
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #661d16), color-stop(1, #ad271d) );
    background:-moz-linear-gradient( center top, #661d16 5%, #ad271d 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#661d16', endColorstr='#ad271d');
    background-color:#661d16;
}

table.purchasedContents tfoot td .paymentCoupon:active {
    position:relative;
    top:1px;
}
</style>
<div class="section purchased">
  <h2 class="section-header">購入情報</h3>
  <% pm,t_shirts = h.order_desc(order) %>
  <div class="section-inner">
    <h3>${order.performance.event.title}</h3>
    <table class="purchasedContents">
      <tbody>
        <tr>
          <thead>
            <th colspan="4">${order.performance.name} ${h.japanese_date(order.performance.start_on)} ${h.japanese_time(order.performance.start_on)} ${order.performance.venue.name}</span></th>
          </thead>
        </tr>
        %for product in order.items:
        <tr>
          <th scope="row"><img src="${request.static_url('altair.app.ticketing.cart:static/img/settlement/icon_dummy.gif')}" alt="" width="22" height="21" /> ${product.product.name}</th>
          <td><strong>${product.seat_quantity}</strong>枚</td>
          <td>
          % if product.product.sales_segment.seat_choice:
            % for seat in product.seats:
              ${seat['name']}<br/>
            % endfor
          % endif
          </td>
          <td class="align1">￥${h.format_number(product.price * product.quantity)}</td>
        </tr>
        %endfor
        <tr>
          <td colspan="3">ステータス</td>
          <td class="textR">${h.order_status(order)}</td>
        </tr>
        <tr>
          <td colspan="3">決済手数料</td>
          <td class="textR">￥${h.format_number(order.transaction_fee)}</td>
        </tr>

        <tr>
          <td colspan="3">発券/引取手数料</td>
          <td class="textR">￥${h.format_number(order.delivery_fee)}</td>
        </tr>

        <tr>
          <td colspan="3">システム利用料</td>
          <td class="textR">￥${h.format_number(order.system_fee)}</td>
        </tr>
        <tr>
          <td colspan="3">合計金額</td>
          <td class="textR">￥${h.format_number(order.total_amount)}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <br />
</div>
<% shipping =order.shipping_address %>
% if order.status == 'canceled' or order.payment_status == 'refunded':
<div class="section">
  <div class="section-inner">
    <p class="red" style="font-size: 20px; font-weight: bold">この注文はキャンセルされました</p>
    <p>
      キャンセル処理は、下記のような理由によりおこなっております。<br />
      ・お客様からキャンセルのご連絡があったため<br />
      ・期限内のご入金がなくキャンセル扱いとしたため<br />
      ・二重注文により、ひとつをキャンセル処理したため<br />
    </p>
  </div>
% else:
<div class="section">
  <h2>お支払</h2>
  <div class="section-inner">
    ${h.render_payment_finished_viewlet(request, order)}
  </div>
</div>
<div class="section">
  <h2>お引取</h2>
  <div class="section-inner">
    ${h.render_delivery_finished_viewlet(request, order)}
  </div>
</div>
% endif
<div class="section">
  <h2>購入者情報</h2>
  <table class="purchasedContents" summary="配送先情報">
    <tbody>
      <tr>
        <th scope="row">氏名（漢字）</th>
        <td>${shipping.last_name} ${shipping.first_name}</td>
      </tr>
      <tr>
        <th scope="row">氏名（カナ）</th>
        <td>${shipping.last_name_kana} ${shipping.first_name_kana}</td>
      </tr>
      <tr>
        <th scope="row">電話番号</th>
        <td>${shipping.tel_1}</td>
      </tr>
      <tr>
        <th scope="row">住所</th>
        <td>${shipping.zip} ${shipping.prefecture}${shipping.city}${shipping.address_1}${shipping.address_2}</td>
      </tr>
    </tbody>
  </table>
</div>
