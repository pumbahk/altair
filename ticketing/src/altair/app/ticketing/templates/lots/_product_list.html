<%namespace file="/common/helpers.html" name="ch" />
<%
  from altair.app.ticketing.cart.helpers import format_currency
%>

<div>
  <h3>対象商品</h3>
  %if not lot.products:
  対象商品は登録されていません。
  <a href="${request.route_url('lots.product_new', lot_id=lot.id)}" class="btn"><i class="icon-plus"></i>新規</a>
  %else:
  <form action="${request.url}" method="post">
    <table class="table table-bordered table-condensed">
      <thead>
        <tr>
          <th>&nbsp;</th>
          <th>公演</th>
          <th>公演日時</th>
          <th>商品名</th>
          <th>席種</th>
          <th>金額</th>
          <th>商品表示順</th>
          <th>&nbsp;</th>
        </tr>
      </thead>
      <tbody>
        %for product in lot.products:
        <tr>
          <td><input type="checkbox" name="product_id" value="${product.id}"></td>
          <td>${product.performance.name}</td>
          <td>${vh.datetime(product.performance.start_on, with_weekday=True)}</td>
          <td>${product.name}</td>
          <td>${product.seat_stock_type.name}</td>
          <td style="text-align: right;">${format_currency(product.price)}</td>
          <td>${product.display_order}</td>
          <td><a class="btn btn-small" href="${request.route_url('lots.product_edit', product_id=product.id)}"><i class="icon-edit"></i>編集</a>
        </tr>
        %endfor
      </tbody>
    </table>
    <div class="btn-group">
      <a href="${request.route_url('lots.product_new', lot_id=lot.id)}" class="btn"><i class="icon-plus"></i>新規</a>
      <button type="submit" name="action-delete" class="btn"><i class="icon-minus"></i>削除</button>
    </div>
  </form>
  %endif
</div>
