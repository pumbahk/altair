<%page args="form" />
<%namespace file="/common/helpers.html" name="ch" />
<%! from altair.app.ticketing.core.models import ReportFrequencyEnum %>

<script type="text/javascript">
  $(function(){
    var modal = $('#modal-sales_reports_mail');
    modal.find('select[name="frequency"]').change(function(){
      if ($(this).val() == ${ReportFrequencyEnum.Weekly.v[0]}) {
        modal.find('.frequency-weekly').css('display', 'block');
      } else {
        modal.find('.frequency-weekly').css('display', 'none');
      }
    }).change();
  });
</script>

<div id="modal-sales_reports_mail" class="modal hide">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">&times;</a>
    <h3>新規メール送信先</h3>
  </div>
  <div class="modal-body">
    <div class="content">
      ${ch.alert_message(form)}
    </div>
    <form class="form-horizontal" action="javascript:save_sales_reports_mail();" method="POST">
      ${ch.form_item(form.operator_id)}
      ${ch.form_item(form.name)}
      ${ch.form_item(form.email)}
      ${ch.form_item(form.frequency)}
      <div class="frequency-weekly">
      ${ch.form_item(form.day_of_week)}
      </div>
      ${ch.form_item(form.period)}
      ${ch.form_item(form.time)}
      ${ch.form_item(form.start_on)}
      ${ch.form_item(form.end_on)}
      <div class="controls">
        * オペレーターの追加は<a href="${request.route_path('operators.index')}">こちら</a>
      </div>
      ${ch.form_item(form.id)}
      ${ch.form_item(form.event_id)}
      ${ch.form_item(form.performance_id)}
    </form>
  </div>

  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">閉じる</a>
    <a href="javascript:void(0);" onclick="$('#modal-sales_reports_mail').find('form').submit();" class="btn">保存</a>
  </div>
</div>
