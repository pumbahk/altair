<%inherit file="./base.html"/>
<%namespace file="./tags_mobile.html" name="mobile" />

<%mobile:header>チケット購入</%mobile:header>

<form method="post" action="${request.url}">
<div>
購入者情報を入力して下さい。
</div>

<div>
<font color="#580d9a">■</font>購入者氏名(全角)
</div>
<div>
  ${form['last_name'].label}
  ${form['last_name']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'last_name')}
  </div>
</div>
<div>
  ${form['first_name'].label}
  ${form['first_name']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'first_name')}
  </div>
<div color="#ff0000">

<div>
<font color="#580d9a">■</font>購入者氏名(カナ)
</div>
<div>
  ${form['last_name_kana'].label}
  ${form['last_name_kana']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'last_name_kana')}
  </div>
</div>
<div>
  ${form['first_name_kana'].label}
  ${form['first_name_kana']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'first_name_kana')}
  </div>
</div>

<div>
<font color="#580d9a">■</font>${form['email_1'].label}
</div>
<div>
  ${form['email_1']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'email_1')}
  </div>
</div>

<div>
<font color="#580d9a">■</font>${form['email_1_confirm'].label}
</div>
<div>
  ${form['email_1_confirm']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'email_1_confirm')}
  </div>
</div>
<p>※ 予約受付完了メール等をメールでご案内します。「tstar.jp」からのメールを受信できるよう、お申し込み前にドメイン指定の設定を必ずお願いいたします。</p>

<div>
<font color="#580d9a">■</font>住所
</div>
<div>
  ${form['zip'].label}(例:1410022)<br/>
  ${form['zip']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'zip')}
  </div>
</div>
<div>
  ${form['prefecture'].label}<br/>
  ${form['prefecture']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'prefecture')}
  </div>
</div>
<div>
  ${form['city'].label}<br/>
  ${form['city']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'city')}
  </div>
</div>
<div>
  住所<br/>
  ${form['address_1']}<br/>
  建物名等<br/>
  ${form['address_2']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'address_1')}
  </div>
</div>

<div>
<font color="#580d9a">■</font>電話番号
</div>
<div>
  ${form['tel_1'].label}<br/>
  ${form['tel_1']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'tel_1')}
  </div>
</div>
<!--
<div>
  ${form['fax'].label}<br/>
  ${form['fax']}
  <div style="color:#ff0000">
    ${h.error_list(request, form, 'fax')}
  </div>
</div>
-->

<hr />
<div>
代金の支払方法を指定して、「次へ進む」ボタンをクリックして下さい。<br>
購入時には、代金のほかに支払方法により、手数料がかかる場合があります。
</div>
<% checked_id = request.params.get('payment_delivery_method_pair_id') %>

%if request.session.peek_flash():
    %for message in request.session.pop_flash():
    <div style="color:red">** ${message} **</div>
    %endfor
%endif

%for m in payment_delivery_methods:
<hr />
<% checked = 'checked' if str(m.id) == checked_id else '' %>
<input type="radio" name="payment_delivery_method_pair_id" id="radio2" value="${m.id}" ${checked}>${m.payment_method.name}+${m.delivery_method.name}<br/>
手数料:${h.format_currency(m.transaction_fee)} (${h.fee_type(m.payment_method.fee_type)}) + ${h.format_currency(m.delivery_fee)} (${h.fee_type(m.delivery_method.fee_type)})<br />
<div>
% if m.payment_method.payment_plugin_id == 1:
<font size="-2">
予約受付完了と同時に決済され、即時予約確定となります。支払回数は≪1回払い≫のみのお取扱いとなります。以下のクレジットカードがご利用できます。<br />
<img src="${request.static_url('ticketing.cart:static/img/mobile/kc_logo_rakuten.gif')}" height="30px" />
<img src="${request.static_url('ticketing.cart:static/img/mobile/visa.gif')}" height="30px" />
<img src="${request.static_url('ticketing.cart:static/img/mobile/master.gif')}" height="30px" />
<img src="${request.static_url('ticketing.cart:static/img/mobile/jcb.gif')}" height="30px" />
<img src="${request.static_url('ticketing.cart:static/img/mobile/amex_logo.gif')}" height="30px" />
</font>
% elif m.payment_method.payment_plugin_id == 3:
<font size="-2">
予約有効期日までにお支払頂きます。<br />
お支払が確認できた時点で予約確定となります。<br />
</font>
% endif
</div>
%endfor
<hr />
<div style="text-align:center" align="center"><input type="submit" value="次に進む" /></div>
<div style="text-align:center" align="center"><input type="submit" name="back" value="戻る" /></div>
</form>
