
https://dev.ticketstar.jp/redmine/altair/issues/924

ユーザーサイド
=============================

申し込みフロー 
--------------------------

画面
+++++++++++

- 抽選申し込み画面 chusen/order/index.html
- 申し込み確認画面 chusen/order/confirm.html
- 申し込み完了画面 chusen/order/completion.html

機能/要件
++++++++++++++++++

- [ ] 0.　イベント詳細ページ/特集ページのようなところから、カートページに飛ぶ
- [ ] 1.　候補として出てくる公演x席種x商品の組み合わせの中から、希望組み合わせを任意希望順に指定、選択
- [x] 3.　購入者情報を入力 :class:`EntryLotView`
- [ ] 7.　申込完了メールが登録メールアドレスに飛んでくる
- [x] x.  申し込み確認ページで申し込み内容を確認できる :class:`ShowLotEntryView`

申し込み確認
----------------------------------

画面
+++++++++++++

- 申し込み番号入力画面
- 申し込み内容確認画面

当選時フロー
----------------------

画面
+++++++++++

- 当選内容確認、決済情報入力画面 chusen/order/index_2.html
- 購入内容確認、メルマガ選択画面 chusen/order/confirm_2.html
- 購入完了画面 chusen/order/completion_2.html

機能/要件
++++++++++++++++++

- [ ] x.　当選通知メールが登録メールアドレスに飛んでくる
- [ ] x.  申し込み確認ページから支払方法 x 受け取り方法選択ページにリンク遷移
- [x] 2.　支払方法ｘ受取方法を選択 :class:`SelectPaymentDeliveryMethod`
- [x] 4.　クレジットカード情報入力
- [x] 5.　申込内容を確認
- [x] 6.　完了
- [ ] x.  注文確認ページで決済確認できる

2,4,5,6 は、既存のカート決済フローを使う。
以下を考慮

- [ ] x.  各ページの戻りを通常カートと当選カートで区別する
- [ ] x.  完了画面の戻り先URLを通常カートと当選カートで区別する
- [ ] x.  決済処理は :mod:`ticketing.payment` に移動する

管理画面
=================================

- [ ] A：抽選予約対象の選定
- [ ] 　A-1.抽選先行対象とする公演x席種を選択
- [ ] 　A-2.抽選先行対象とする座席を選択 (商品を選択するのと同義)
- [ ] 　A-3.抽選対象とした公演x座席（含む席種情報）を出力して確認
- [ ] B: 抽選条件登録
- [ ] 　B-1.選択した対象に対する受付設定の設定 (販売区分)
- [ ] 　B-2.その他の条件の設定
- [ ] C.　抽選（当選）処理
- [ ] 　C-1：抽選処理を行いたい公演を選択 (公演は無理。イベントを選択する)
- [ ] 　C-2：抽選処理画面にて、全体進捗を確認（下記はGettiiの項目例）
- [ ] 　C-3：受付一覧詳細の確認/印刷
- [-] 　- C-4：自動抽選/自動席割処理
- [-] 　- C-5：当選割り当て結果の閲覧→マニュアル調整
- [ ]   C-X: 当選情報取り込み :function:``
- [ ] 　C-6：予約の確定→ _決済処理_（割り当てた当選者・当選予約を確定）
- [ ] 　C-7：未確定→落選の処理
- [ ] 　C-8.1：当選メール送信 -> ユーザーサイド 当選時フロー
- [ ] 　C-8.2：落選メール送信 
- [-] 　C-9：落選復活
