<%inherit file="/layout.html"/>
<%namespace file="/common/helpers.html" import="validate_errors" />
<%namespace file="/common/helpers.html" import="alert_message" />
<%namespace file="/common/helpers.html" import="flash_messages" />
<%namespace file="/common/helpers.html" import="form_item" />
<%namespace file="/common/helpers.html" import="breadcrumbs" />

<%
  if request.matched_route.name == 'payment_delivery_method_pair.edit':
    route_name = u'編集'
    route_path = request.route_path('payment_delivery_method_pair.edit', payment_delivery_method_pair_id=form.id.data)
  else:
    route_name = u'登録'
    route_path = request.route_path('payment_delivery_method_pair.new', sales_segment_id=sales_segment.id)
%>

<div class="row-fluid">
  <%include file="/parts/_menu.html" />

  <div class="span10">
    ${breadcrumbs(
      names=[u'イベント', sales_segment.event.title, u'販売区分', sales_segment.name],
      urls=[
        request.route_path('events.index'),
        request.route_path('events.show', event_id=sales_segment.event.id),
        request.route_path('sales_segments.index', event_id=sales_segment.event.id),
      ]
    )}
  </div>

  <span class="span10">
    <div class="page-header">
      <h3>決済・配送方法${route_name}</h3>
    </div>

    <div class="content">
      ${flash_messages(request)}
      ${alert_message(form)}
    </div>

    <div class="well">
      <form class="form-horizontal" action="${route_path}" enctype="multipart/form-data" method="POST">
        <fieldset>
          ${form_item(form.transaction_fee, option={'class':'span2'})}
          ${form_item(form.delivery_fee, option={'class':'span2'})}
          ${form_item(form.discount, option={'class':'span2'})}
          ${form_item(form.discount_unit, option={'class':'span2'})}
          ${form_item(form.discount_type, option={'class':'span2'})}

          % if request.matched_route.name == 'payment_delivery_method_pair.new':
            ${form_item(form.payment_method_ids)}
            ${form_item(form.delivery_method_ids)}
          % else:
            ${form_item(form.payment_method_ids, option={'disabled':'disabled'})}
            ${form_item(form.delivery_method_ids, option={'disabled':'disabled'})}
          % endif

          ${form_item(form.sales_segment_id)}
        </fieldset>
        <div class="form-actions">
          <input class="btn btn-primary" type="submit" name="submit" value="保存">
        </div>
      </form>
    </div>
  </span>
</div>
