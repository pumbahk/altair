<%inherit file="../layout.html" />
<%namespace file="/common/confirm_modal.html" import="delete_modal"/>
<%namespace file="/common/helpers.html" import="flash_messages" />

<div class="row-fluid">
  <%include file="_menu.html" />

  <span class="span10">
    <div class="page-header">
      <h3>${newsletter.subject}</h3> 
    </div>

    <div class="content">
      ${flash_messages(request)}
    </div>

    <table class="table table-striped">
      <tbody>
        <tr>
          <th class="span2">${form.subject.label}</th>
          <td>${newsletter.subject}</td>
        </tr>
        <tr>
          <th>${form.description.label}</th>
          <td>${newsletter.description.replace("\n", "<br />")|n}</td>
        </tr>
        <tr>
          <th>${form.status.label}</th>
          <td>
            % if newsletter.status == 'editing':
              <span class="label label-important">作成中</span>
            % elif newsletter.status == 'waiting':
              <span class="label label-warning">配信予約中</span>
            % elif newsletter.status == 'completed':
              <span class="label label-success">配信完了</span>
            % endif
          </td>
        </tr>
        <tr>
          <th>${form.subscriber_file.label}</th>
          <td>${newsletter.subscriber_file()}</td>
        </tr>
        <tr>
          <th>${form.subscriber_count.label}</th>
          <td>${newsletter.subscriber_count}</td>
        </tr>
        <tr>
          <th>${form.start_on.label}</th>
          <td>${newsletter.start_on}</td>
        </tr>
      </tbody>
    </table>
  </span>
</div>

<div class="ui-toolbar">
  <div class="btn-group pull-right">
    <button class="btn"><a href="${request.route_path('newsletters.new')}"><i class="icon-plus"></i> 新規</a></button>
    <button class="btn">
      <a href="${request.route_path('newsletters.edit', id=newsletter.id)}"><i class="icon-pencil"></i> 編集</a>
    </button>
    <a class="btn" data-controls-modal="confirm-modal" data-backdrop="true" data-keyboard="true"
        href="javascript:$('#confirm-modal').modal('toggle');"
        onclick="$('#confirm-modal #delete').attr('href', '/newsletters/delete/${newsletter.id}');">
      <i class="icon-minus"></i> 削除
    </a>
    <button class="btn">
      <a href="${request.route_path('newsletters.copy', id=newsletter.id)}"><i class="icon-plus"></i> コピー</a>
    </button>
  </div>
  ${delete_modal("Are you sure you want to delete this id?")}
</div>
