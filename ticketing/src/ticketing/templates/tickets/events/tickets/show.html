## almost tickets/templates/show.html

<%
event_id = request.matchdict["event_id"]
event = request.context.event
%>

<%inherit file="../../../layout_2cols.html" />
<%namespace file="/common/helpers.html" import="breadcrumbs,pager,flash_messages"/>
<% import json %>
<%block name="javascript">
<script type="text/javascript" src="/static/js/fashion.js"></script>
<![if !(lt IE 9)]>
<script type="text/javascript" src="/static/js/fashion.svg.js"></script>
<![endif]>
<!--[if (lt IE 9)]> 
<script type="text/javascript" src="/static/js/fashion.vml.js"></script>
<![endif]-->
<script type="text/javascript" src="/static/js/ticketing.ticket-viewer.js"></script>
</%block>

<div class="breadcrumbs">
  ${breadcrumbs(
    names=[u'イベント', event.title, u'券面', u"チケットテンプレート"],
    urls=[request.route_path('events.index'), 
          request.route_path('events.show', event_id=event.id),
          request.route_path('events.tickets.index', event_id=event.id),
         ]
  )}
</div>

<div class="page-header">
  <h1>チケットテンプレート</h1>
</div>
<div class="content">
  ${flash_messages(request)}
</div>

<div class="row-fluid">
  <div class="span6">
    <h3>詳細</h3>
    <table class="table table-striped table-bordered">
      <tbody>
        <tr>
          <th class="span2">名称</th>
          <td class="span3">${template.name}</td>
        </tr>
        <tr>
          <th class="span2">チケット様式</th>
          <td class="span3"><a href="${request.route_path("tickets.formats.show",id=template.ticket_format_id)}">
			  ${template.ticket_format.name}
		  </td>
        </tr>
        <tr>
          <th class="span2">作成日時</th>
          <td class="span3">${template.created_at}</td>
        </tr>
        <tr>
          <th class="span2">更新日時</th>
          <td class="span3">${template.updated_at}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="span6"></div>
</div>

<div class="row-fluid">
  <div id="ticket-viewer" style="height:300px"></div>
  <script type="text/javascript">
var options = ${json.dumps({ 'dataSource': request.route_url('events.tickets.boundtickets.data', event_id=event_id, id=template.id)})|n};
$('#ticket-viewer').ticketviewer(options).ticketviewer('load');
</script>
</div>

<div class="row-fluid well">
  <div class="btn-group">
    <a href="${request.route_path("events.tickets.boundtickets.edit",event_id=event_id, id=template.id)}" class="btn">
      <i class="icon-pencil"></i> 編集
    </a>
        <button class="btn dropdown-toggle" data-toggle="dropdown">
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
          <li>
            <a href="#deleteModal" data-toggle="modal">
              <i class="icon-minus"></i> 削除
            </a>
          </li>
		  <li>
			<a href="${request.route_path("events.tickets.boundtickets.download",event_id=event_id, id=template.id)}">
			  <i class="icon-minus"></i> 登録されている内容をdownload
			</a>
		  </li>
        </ul>
  </div>
</div>

<div class="modal hide" id="deleteModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">×</button>
    <h3>確認</h3>
  </div>
  <div class="modal-body">
    このチケットテンプレートを削除します。よろしいですか？
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">キャンセル</a>
    <form action="${request.route_path("events.tickets.boundtickets.delete",event_id=event_id, id=template.id)}" method="POST">
      <button type="submit" class="btn">削除する</button>
    </form>
  </div>
</div>
