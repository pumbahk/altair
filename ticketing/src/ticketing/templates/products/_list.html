<%page args="event=None, performance=None" />
<%namespace file="/common/helpers.html" import="safe_strftime" />

% if event and len(event.products) > 0:
  <table class="table table-striped table-bordered table-condensed">
    <thead>
      <tr>
        <th class="minwidth"></th>
        <th class="minwidth">ID</th>
        <th><a href="#" class="sortable">商品名</a></th>
        <th><a href="#" class="sortable">価格</a></th>
        <th><a href="#" class="sortable">販売区分</a></th>
        <th><a href="#" class="sortable">販売開始日時</a></th>
        <th><a href="#" class="sortable">販売終了日時</a></th>
      </tr>
    </thead>
    <tbody>
    % for product in event.products:
      <tr id="product-${product.id}">
        <th class="minwidth"><input type="radio" name="product_id" value="${product.id}" /></th>
        <td id="id">${product.id}</td>
        <td><a href="javascript:edit_product('${product.id}');" id="name">${product.name}</a></td>
        <td id="price">${product.price}</td>
        % if product.sales_segment:
        <td>
          <a href="${request.route_path('sales_segments.show', sales_segment_id=product.sales_segment.id)}">
            ${product.sales_segment.name}
          </a>
          <hidden id="sales_segment" value="${product.sales_segment.id}" />
        </td>
        <td>${safe_strftime(product.sales_segment.start_at)}</td>
        <td>${safe_strftime(product.sales_segment.end_at)}</td>
        % else:
        <td></td>
        <td></td>
        <td></td>
        % endif
      </tr>
      % if performance and product.items:
      <tr>
        <td colspan="7">
            <span class="pull-right" style="width:300px">
              <table class="table table-striped table-bordered table-condensed">
                <tr>
                  <th>席種</td>
                  <th>席数</td>
                  <th>単価</td>
                </tr>
                % for item in product.items:
                <tr>
                  <td>${item.stock.seat_type.name}</td>
                  <td>${item.stock.quantity}</td>
                  <td>${item.price}</td>
                </tr>
                % endfor
              </table>
            </span>
        </td>
      </tr>
      % endif
    % endfor
    </tbody>
  </table>
% endif
