<%inherit file="../layout_2cols.html" />
<%namespace file="/common/helpers.html" name="h" />
<% tab = request.matchdict.get('tab', 'seat-allocation') %>
<% route_path = request.route_path('performances.show', performance_id=performance.id) %>
<%block name="style">
<link rel="stylesheet" type="text/css" href="/static/css/decentcolorpicker.css" />
<link rel="stylesheet" type="text/css" href="/static/css/performance.css" />
</%block>
<%block name="javascript">
<script type="text/javascript" src="/static/js/fashion.js"></script>
<![if !(lt IE 9)]>
<script type="text/javascript" src="/static/js/fashion.svg.js"></script>
<![endif]>
<!--[if (lt IE 9)]> 
<script type="text/javascript" src="/static/js/fashion.vml.js"></script>
<![endif]-->
<script type="text/javascript" src="/static/js/jquery.decentcolorpicker.js"></script>
<script type="text/javascript">
$(function () {
  $(".kolorPicker").decentcolorpicker();
});
</script>
<script type="text/javascript" src="/static/js/ticketing.performance.js"></script>
<script type="text/javascript" src="/static/js/ticketing.venue-editor.js"></script>
</%block>
<div class="breadcrumbs">
  ${h.breadcrumbs(
      names=[u'イベント', performance.event.title, u'パフォーマンス', performance.name],
      urls=[
        request.route_path('events.index'),
        request.route_path('events.show', event_id=performance.event.id),
        request.route_path('performances.index', event_id=performance.event.id),
      ]
  )}
</div>
<div class="page-header">
  <h1>
    ${performance.event.title}<br />
    <small>${performance.name}</small>
  </h1>
</div>

<div class="content">
  ${h.flash_messages(request)}
</div>

<div class="row-fluid">
  <div class="span9">
    <table class="table table-bordered table-condensed">
      <tbody>
        <tr>
          <th>開場</th>
          <td>${h.safe_strftime(performance.open_on)}</td>
          <th>公演コード</th>
          <td>${performance.code}</td>
        </tr>
        <tr>
          <th>開演</th>
          <td>${h.safe_strftime(performance.start_on)}</td>
          <th>会場</th>
          <td>${performance.venue.name}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <input type="hidden" id="performance_id" value="${performance.id}"></input>
  <div class="span3">
    <%include file="/performances/_action_button.html" args="event=performance.event, order=['edit', 'delete', 'copy']" />
  </div>
</div>

<div class="tabbable tabs-top" id="tabbable-content">
  <ul class="nav nav-tabs">
    <li id="seat-allocation-tab"><a href="${route_path}/seat-allocation">席種／配券</a></li>
    <li id="product-tab"><a href="${route_path}/product">商品</a></li>
    <li id="reservation-tab"><a href="${route_path}/reservation">予約</a></li>
    <li id="ticket-designer-tab"><a href="${route_path}/ticket-designer">チケット券面</a></li>
  </ul>
  <div class="tab-content" id="tabbable-tab-content">
    % if tab == 'product':
    <div class="tab-pane" id="product">
      <%include file="./_product.html" args="performance=performance, form_product=form_product, form_product_item=form_product_item" />
    </div>
    % elif tab == 'reservation':
    <div class="tab-pane" id="reservation">
      <%include file="./_reservation.html" args="form=form_order, form_search=form_search, orders=orders" />
    </div>
    % elif tab == 'ticket-designer':
    <div class="tab-pane" id="ticket-designer">
      <%include file="./_ticket_designer.html" />
    </div>
    % else:
    <div class="tab-pane" id="seat-allocation">
      <%include file="./_seat_allocation.html" args="performance=performance, form_stock_holder=form_stock_holder" />
    </div>
    % endif
  </div>

  <script type="text/javascript">
$(function() {
tab = '#${tab}';
$(tab + '-tab').addClass('active');
$(tab).addClass('active');
});
</script>
</div>
