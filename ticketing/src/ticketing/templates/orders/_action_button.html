<%page args="order" />
<%namespace file="/common/helpers.html" name="h" />
<%namespace file="/common/modal.html" name="m" />

<script type="text/javascript">
  function cancel_order(id) {
    modal = $('#modal-delete');
    modal.find('#delete').attr('href', '/orders/cancel/' + id);
    modal.find('#message').text("${u'選択した受注をキャンセルします。よろしいですか？'}");
    modal.modal('toggle');
  }
</script>

<%
actions = {
  'delivered':dict(
    label=u'配送済みにする',
    url=request.route_path('orders.delivered', order_id=order.id),
    icon='icon-ok',
  ),
  'print':dict(
    label=u'発券する',
     url=request.route_path('orders.print.queue', order_id=order.id),
    icon='icon-print',
  ),
  'cancel':dict(
    label=u'キャンセル',
    url='javascript:cancel_order(%d);' % order.id,
    icon='icon-remove',
  ),
}
sort = iter(['delivered','cancel'])
%>
${h.action_button(actions, sort, virtical=False)}

${m.delete_modal(label_delete=u'キャンセル', label_cancel=u'戻る')}

## 発券するボタンを追加する
<script type="text/javascript">
  $(function(){
	var btn = $("<a>").attr("href", "${request.route_path("orders.print.queue.dialog", order_id=order.id)}")
					  .attr("data-toggle","modal")
					  .attr("data-target", "#PrintQueueModal")
					  .attr("class", "ajax-modal btn")
	                  .html("<i class='icon-print'></i> 発券する");
	$(".btn-group").eq(0).append(btn);
  });
</script>
