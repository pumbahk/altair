<%page args="form, action='#'" />
<% from wtforms.widgets import HiddenInput %>
<%namespace file="/common/helpers.html" name="h" />

<script>
(function($) {
var pdmp_map = ${pdmp_map|n};
$(function() {
$('#sales_segment_group_id').change(function() {
var sales_segment_group_id = $(this).val();
$('#payment_delivery_method_pairs').empty();
var pdmps = pdmp_map[sales_segment_group_id];

for (var i=0; i < pdmps.length; i++) {
    var pdmp = pdmps[i];
    $('#payment_delivery_method_pairs').append(
      $('<option value="' + pdmp[0]+ '">' + pdmp[1] + '</option>')
    );
}
});
});

})($);
</script>
<form action="${action}" method="POST">
  ${h.form_item(form.id)}
  % if not form.sales_segment_group_id.data:
    ${h.form_item(form.sales_segment_group_id, class_='span8')}
  % else:
    <input type="hidden" name="${form.sales_segment_group_id.name}" value="${form.sales_segment_group_id.data}" />
  % endif
  % if not form.performance_id.data:
    ${h.form_item(form.performance_id, class_='span8')}
  % else:
    <input type="hidden" name="${form.performance_id.name}" value="${form.performance_id.data}" />
  % endif
  ${h.form_item(form.payment_delivery_method_pairs)}
  ${h.form_item(form.start_at, class_="datefield")}
  ${h.form_item(form.end_at, class_="datefield")}
  ${h.form_item(form.upper_limit)}
  ${h.form_item(form.seat_choice)}
  ${h.form_item(form.public)}
</form>
