<%inherit file="/layout.html"/>
<%namespace file="/common/helpers.html" import="pager"/>                                               
<%namespace file="/common/helpers.html" import="flash_messages" />
<%namespace file="/common/helpers.html" import="safe_strftime" />

<script type="text/javascript">
  $(function() {
    $('#start_at').datetimepicker({dateFormat:'yy-mm-dd', timeFormat:'hh:mm'});
    $('#end_at').datetimepicker({dateFormat:'yy-mm-dd', timeFormat:'hh:mm'});
  });
</script>

<div class="row-fluid">
  <%include file="/parts/_menu.html" />

  <span class="span10">
    <div class="page-header">
      <h3>販売区分</h3>
    </div>

    <div class="content">
      ${flash_messages(request)}
    </div>

    <table class="table table-striped table-bordered table-condensed">
      <thead>
      <tr>
        <th class="minwidth"><input type="checkbox" class="__action__-select_all" /></th>
        <th class="minwidth">ID</th>
        <th><a href="#" class="sortable">名称</a></th>
        <th><a href="#" class="sortable">販売開始日時</a></th>
        <th><a href="#" class="sortable">販売終了日時</a></th>
        <th>決済方法</th>
        <th>配送方法</th>
      </tr>
      </thead>
      <tbody>
      % for sales_segment in sales_segments:
        <tr>
          <% count = len(sales_segment.payment_delivery_method_pair) %>
          <% rowspan = 'rowspan=%s' % (count) %>
          <td ${rowspan}><input type="radio" name="sales_segment_id" value="${sales_segment.id}" /></td>
          <td ${rowspan}>${sales_segment.id}</td>
          <td ${rowspan}><a href="${request.route_path('sales_segments.show', sales_segment_id=sales_segment.id)}">${sales_segment.name}</a></td>
          <td ${rowspan}>${safe_strftime(sales_segment.start_at)}</td>
          <td ${rowspan}>${safe_strftime(sales_segment.end_at)}</td>
          % if count == 0:
          <td></td>
          <td></td>
          % endif
        % for i, payment_delivery_method_pair in enumerate(sales_segment.payment_delivery_method_pair):
          % if i != 0:
        <tr>
          % endif
          <td>${payment_delivery_method_pair.payment_method.name}</td>
          <td>${payment_delivery_method_pair.delivery_method.name}</td>
        </tr>
        % endfor
      % endfor
      </tbody>
    </table>
    <%include file="/sales_segments/_action_button.html" args="event=event, form=form_ss" />
  </span>
</div>
