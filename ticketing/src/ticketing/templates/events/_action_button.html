<%page args="event" />
<%namespace file="/common/modal.html" import="delete_modal" />

<script type="text/javascript">
  function delete_event(id) {
    $('#modal-delete #delete').attr('href', '/events/delete/' + id);
    $('#modal-delete #message').text("${u'選択したイベントを削除します。よろしいですか？'}");
    $('#modal-delete').modal('toggle');
  }
  function sync_event(id) {
    if (!id) return;
    $(location).attr('href', '/events/sync/' + id);
  }
</script>

<div class="btn-group" style="float: left;">
  <a href="${request.route_path('events.new')}" class="btn">
    <i class="icon-plus"></i> 新規
  </a>
  <button class="btn dropdown-toggle" data-toggle="dropdown">
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li>
      <a href="${request.route_path('events.show', event_id=event.id)}">
        <i class="icon-th-list"></i> 詳細
      </a>
    </li>
    <li>
      <a href="${request.route_path('events.edit', event_id=event.id)}">
        <i class="icon-pencil"></i> 編集
      </a>
    </li>
    <li>
      <a href="javascript:delete_event(${event.id})" data-controls-modal="modal-delete" data-backdrop="true" data-keyboard="true">
        <i class="icon-minus"></i> 削除
      </a>
    </li>
    <li class="divider"></li>
    <li><a href=""><i class="icon-minus"></i> 料率設定</a></li>
    <li><a href=""><i class="icon-minus"></i> チケット券面</a></li>
  </ul>
</div>

<div class="btn-group" style="float: left;">
  <a class="btn btn-inverse" data-toggle="modal" href="#modal-sync" style="margin-left: 5px;">
    <i class="icon-refresh icon-white"></i> CMSへ送信
  </a>
</div>

<div style="clear: left;"></div>

<div id="modal-sync" class="modal hide fade">
  <div class="modal-header">
    <a href="#" class="close">&times;</a>
    <h3>確認</h3>
  </div>

  <div class="modal-body">
    <p>CMSへイベントを送信します。よろしいですか？</p>
  </div>

  <div class="modal-footer">
    <a href="javascript:$('#modal-sync').modal('hide');" class="btn secondary">キャンセル</a>
    <a id="sync" href="javascript:sync_event(${event.id});" class="btn danger">送信</a>
  </div>
</div>

${delete_modal()}
