<%inherit file="/layout.html"/>
<%namespace file="/common/helpers.html" import="pager"/>
<%namespace file="/common/helpers.html" import="flash_messages" />
<%namespace file="/common/helpers.html" import="breadcrumbs" />

<div class="modal fade" id="modal-search">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">×</a>
    <h3>検索条件設定</h3>
  </div>

  <div class="modal-body">
    <form action="">
      <label>イベント</label>
        <input type="text" class="span3" placeholder="イベント名">
        <label>パフォーマンス</label>
        <input type="text" class="span3" placeholder="パフォーマンスコード">
        <label>公演日</label>
        <input type="text" class="span3" placeholder="2012/07/01 18:00">
    </form>
  </div>

  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">閉じる</a>
    <a href="#" class="btn btn-primary">検索</a>
  </div>
</div>

<div class="row-fluid">
  <%include file="/parts/_menu.html" />

  <div class="span10">
    ${breadcrumbs(
        names=[u'トップ', u'イベント'],
        urls=[request.route_path('index')]
    )}
  </div>

  <span class="span10">
    <div class="page-header">
      <h3>イベント</h3>
    </div>

    <div class="content">
      ${flash_messages(request)}
    </div>

    <ul class="nav nav-pills">
      <li class="dropdown" id="top-event">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#top-even1t">
          イベント
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a data-toggle="modal" href="${request.route_path('events.new')}" >新規イベント</a></li>
          <li><a data-toggle="modal" href="#modal-new-stock-group-send" >イベントをコピー</a></li>
          <li class="divider"></li>
        </ul>
      </li>
      <li class="dropdown" id="top-search">
        <a data-toggle="modal" href="#modal-search">
        検索条件設定
        </a>
      </li>
      <li class="dropdown" id="top-search-text">
        <input type="text" class="search-query span2" placeholder="Search">
      </li>
    </ul>

    % for event in events.items:
    <div class="well">
      <h4 style="word-wrap: break-word;">${event.title}</h4>
      <div class="pull-right">
        <%include file="/events/_action_button.html" args="event=event" /> 
      </div>
      <div style="clear: both"></div>
      <%
        label_classes = [
          'label-important',
          'label-warning',
          'label-default',
          'label-success',
          'label-info',
          'label-inverse'
        ]
      %>
      % for i, sales_segment in enumerate(event.sales_segments):
        <span class="label ${label_classes[i%6]}">${sales_segment.name}</span>
      % endfor
      <%include file="/performances/_list.html" args="form=form_performance, performances=event.performances, limit=5" />
    </div>
    % endfor
  </span>
  ${pager(events)}
</div>
