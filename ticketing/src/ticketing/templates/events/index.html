<%inherit file="../layout.html"/>
<%block name="title">イベント一覧</%block>


<div class="modal fade" id="modal-search">
    <div class="modal-header">
        <a class="close" data-dismiss="modal">×</a>
        <h3>検索条件設定</h3>
    </div>

    <div class="modal-body">
        <form action="">
            <label>イベント</label>
            <input type="text" class="span3" placeholder="パフォーマンス名">
            <label>パフォーマンス</label>
            <input type="text" class="span3" placeholder="パフォーマンスコード">
            <label>公演日</label>
            <input type="text" class="span3" placeholder="2012/07/01 18:00">
        </form>
    </div>

    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">閉じる</a>
        <a href="#" class="btn btn-primary">検索</a>
    </div>
</div>


<div class="row-fluid">


    <span class="span10">
        <ul class="nav nav-pills">
            <li class="dropdown" id="top-event">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#top-even1t">
                    イベント
                    <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li><a data-toggle="modal" href="${request.route_path('events.new')}" >新規イベント</a></li>
                    <li><a data-toggle="modal" href="#modal-new-stock-group-send" >イベントをコピー</a></li>
                    <li class="divider"></li>
                </ul>
            </li>
            <li class="dropdown" id="top-search">
                <a data-toggle="modal" href="#modal-search">
                検索条件設定
                </a>
            </li>
            <li class="dropdown" id="top-search-text">
                <input type="text" class="search-query span2" placeholder="Search">
            </li>
        </ul>

% for event in events.items:
        <div class="well">
            <h4 style="float: left">${event.title}</h4>
            <div class="btn-group" style="float: right; margin-right: 20px">
                <a href="${request.route_path('events.edit', event_id = event.id)}" class="btn" ><i class="icon-pencil"></i>編集</a>
                <button class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li><a href=""><i class="icon-plus"></i>コピー</a></li>
                    <li><a href="${request.route_path('performances.new', event_id=event.id)}" class="new-performance"><i class="icon-plus"></i>新規パフォーマンス</a></li>
                    <li class="divider"></li>
                    <li><a href=""><i class="icon-minus"></i>料率設定</a></li>
                    <li class="divider"></li>
                    <li><a href=""><i class="icon-minus"></i>削除</a></li>
                </ul>
            </div>
            <br style="clear: both" />
            <span class="label label-important">先行</span>
            <span class="label label-success">一般</span>
            <table class="table fullwidth checkboxed_table">
                <thead>
                    <tr>
                        <th class="minwidth"><input type="checkbox" class="__action__-select_all" /></th>
                        <th class="minwidth">ID</th>
                        <th><a href="#" class="sortable">名称</a></th>
                        <th><a href="#" class="sortable">会場</a></th>
                        <th><a href="#" class="sortable">開場</a></th>
                        <th><a href="#" class="sortable">開演</a></th>
                        <th><a href="#" class="sortable">閉演</a></th>
                    </tr>
                </thead>
                <tbody>
    % for performance in event.performances:
                    <tr>
                        <td><input type="checkbox" /></td>
                        <td><a href="${request.route_path('performances.show', performance_id=performance.id)}">${performance.id}</a></td>
                        <td><a href="${request.route_path('performances.show', performance_id=performance.id)}">${performance.name}</a></td>
                        <td><a href="#">${performance.venue.name if performance.venue else "-"}</a></td>
                        <td>${performance.open_on}</td>
                        <td>${performance.start_on}</td>
                        <td>${performance.end_on}</td>
                    </tr>
    % endfor
                </tbody>
            </table>
            <div style="float: right"><a href="">このイベントの他の公演を見る</a></div>
            <br style="clear: both" />
        </div>
% endfor
        <div class="pagination">
            <ul>
                <li><a href="#">Prev</a></li>
                <li class="active">
                    <a href="#">1</a>
                </li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">Next</a></li>
            </ul>
        </div>
    </span>

    <span class="span2">
        <div class="well">
            <ul class="nav nav-list">
                <li class="nav-header">MENU</li>
                <li><a href=""><i class="icon-home"></i>販売条件マスタ</a></li>
                <li><a href=""><i class="icon-home"></i>会場席種マスタ</a></li>
                <li><a href=""><i class="icon-home"></i>券種</a></li>
                <li><a href=""><i class="icon-home"></i>商品</a></li>
                <li class="divider"></li>
            </ul>
        </div>
    </span>
</div>

<script type="text/javascript">
    $('.new-performance').click(function(e) {
        e.preventDefault();
        var href = $(e.target).attr('href');
        if (href.indexOf('#') == 0) {
            $(href).modal('open');
        } else {
            $.get(href, function(data) {
                $('<div class="modal fade" >' + data + '</div>').modal();
            });
        }
    });
</script>


<div class="ui-toolbar">
  <a href="${request.route_path('events.new')}" class="btn">新規イベント</a>
</div>