公開カレンダウィジェット
============================

イベントの公開カレンダを表示するウィジェット。

イベントのカレンダ情報はバックエンドより取得し、CMS側で一定時間キャッシュする。
テンプレートへの直接記述またはincludeファイル、あるいはAjaxでの呼び出しを行う想定。

.. image:: ../images/calendar.png

.. note:: カレンダの表示種類を確定する。3種類くらい？


バックエンド通信
---------------------

公開カレンダの情報はバックエンドから取得する。
取得したカレンダ情報は一定時間キャッシュする。キャッシュ時間はTBD。
バックエンドへの問い合わせは月単位で行うものとする（年だと範囲が広すぎるし、3ヶ月などは単位として管理が大変なため）。

:URL: http://backend-ticketstar/calendar/{year}/{month}
:Method: GET
:Content-Type: application/json



課題

* カレンダを見せるユーザを限定する必要があるか？

 * クライアント
 * ファンクラブ会員
 * 前回購入者

* CMS側で認証処理、認証パーミッションのハンドリングが必要


種類
-----------------

提供するカレンダの機能は以下の２つ

+ 縦に広げた帯状の表示(帯)
+ 各月ごとのタブ表示(タブ)


帯
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

#. 最初のパフォーマンス開催日／最後のパフォーマンス開催日の±１週間の範囲でカレンダ表示
#. 必ず、行は埋める(e.g. 31,1,2,3,4,5,6というように)
#. 各日付はパフォーマンスへのリンクを持っていることがある。

タブ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
#. 月毎にタブで出し分ける。
#. 表示する付きはパフォーマンスが存在する月のみ

データ構造
-----------------

see also: :ref:`object-calendar`
