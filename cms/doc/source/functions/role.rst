ロール管理
====================

本機能は、サイト管理者は個々のオブジェクトを操作する際の権限管理を提供する。

バックエンドから各モデルの閲覧者、編集者、メールマガジン管理者といったロールを定義し、
サイト管理者に対して割り当てることでセキュリティを確保する。


=================
ロール一覧（仮）
=================

ロールとパーミッションの対応は以下のとおり。

.. csv-table::
   :header: ロール名, 対象モデル, READ, CREATE, UPDATE, DELETE, 備考

   event_viewer, イベント, o, --, --, --, 編集はバックエンドで行う
   ticket_viewer, チケット（パフォーマンス）, o, --, --, --, 編集はバックエンドを行う
   page_viewer, レイアウト、ページ, o, --, --, --,
   page_editor, レイアウト、ページ, o, o, o, o,
   topic_viewer, トピック, o, --, --, --,
   topic_editor, トピック, o, o, o, o,
   asset_viewer, アセット, o, --, --, --,
   asset_editor, アセット, o, o, o, o,
   tag_viewer, タグ, o, --, --, --,
   tag_editor, タグ, o, o, o, o,
   magazine_viewer, メールマガジン, o, --, --, --,
   magazine_editor, メールマガジン, o, o, o, o,
   administrator, 全て, o, --, --, --,


=====================
ロールの設定
=====================

バックエンドとCMSの間で事前にロール名を定義する。

オペレータがCMSを利用開始する際にOAuth認証を行い、認証完了時にバックエンドからロール名を送信する。
ロール名を元に個々のオブジェクト操作ビューに対してパーミッションを割り当てる。
割り当てられたパーミッションはログインセッションが有効な限り保持し続ける。

ロール名に対するパーミッションはCMS上から変更することができる。


=====================
ロール確認動作
=====================

ロール確認はページ表示時にpyramidの認証ポリシ管理機能
（ `authorization policy <http://readthedocs.org/docs/pyramid/en/1.2-branch/glossary.html#term-authorization-policy>`_ ）により行う。
ロールを持たないユーザはHTTPForbiddenオブジェクトのスローによりログインページが表示される。
