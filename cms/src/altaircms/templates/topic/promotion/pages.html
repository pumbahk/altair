<%inherit file='altaircms:templates/layout_2col.html'/>

<%namespace name="fco" file="altaircms:templates/formcomponents.html"/>
<%namespace name="nco" file="altaircms:templates/navcomponents.html"/>

<%block name="style">
<style type="text/css">
  .row-fluid h3 { margin-top:20px;  }
  .row-fluid h3.first { margin-top:0px;  }
</style>
</%block>

<h2>プロモーション枠使用ページ一覧</h2>

<div class="row-fluid">
  <div class="span12">
    ${nco.breadcrumbs(
        names=["Top", u"プロモーション枠使用ページ一覧"], 
        urls=[request.route_path("dashboard")])
    }
  </div>
</div>

<div class="row-fluid">

<p>全${pages.opts.get("item_count") or pages.collection.count()}件</p>
${pages.pager()}
<table class="table table-striped">
  <thead>
    <tr>
      <th>ページセット</th>
      <th>ページ</th>
      <th>promotion widget</th>
    </tr>
  </thead>
    <tbody>
        %for pageset,page,widget,tag in grid:
          <tr>
            %if pageset:
              <td rowspan="${pageset.rowspan}">${pageset.values.name}</td>
            %endif
            %if page:
              <% current_page_id = page.values.id %>
              <td rowspan="${page.rowspan}">
                <a href="${request.route_path("promotion_detail", page_id=page.values.id)}">${page.values.name}</a>
                (${h.term(page.values.publish_begin, page.values.publish_end)})</td>
            %endif
            <td><a href="${request.route_path("promotion_detail", page_id=current_page_id, _query=(dict(widget_id=widget.values.id)))}">${widget.values.id}</a></td>
            <td>表示場所:${tag.values.label}</td>
          </tr>
        %endfor
    </tbody>
</table>
${pages.pager()}
</div>
