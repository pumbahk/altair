[buildout]
extends =
    ./pmain.cfg
    ./versions.cfg

allow-picked-versions = false

parts =
    altairticketing
    egg-scripts
    pmain
    prepare
    prepare2
    supervisord

develop = 
    ../../altair_versiontools
    ../../ticketing
    ../../cms
    ../../commons
    ../../altair_gaq
    ../../altair_findable_label
    ../../altair_log
    ../../altair_browserid
    ../../altair_auth
    ../../altair_exclog
    ../../altair_now
    ../../altair_encodingfixer
    ../../altair_logicaldeleting

versions = versions

find-links =
    file:${buildout:directory}/../../bundle/index.html

[prepare]
recipe = z3c.recipe.mkdir
paths = 
    var/altair/cms
    var/altair/ticketing
    var/log

[prepare2]
recipe = z3c.recipe.filetemplate
files =
    cancel_auth_expired_carts.conf
    update_seat_status.conf
    send_sales_reports.conf
    rakuten_checkout_sales.conf
    copy_seat_adjacency.conf

[altairticketing]
recipe = zc.recipe.egg
eggs = 
    ticketing
    altair_cms
    pyramid
    altair_gaq
    altair.findable_label
    altair.log
    altair.browserid
    altair-commons
    altair.auth
    altair.encodingfixer
    altair.logicaldeleting
interpreter = altairpy

[egg-scripts]
recipe = zc.recipe.egg:scripts
eggs = 
    alembic
    ticketing
    altair-cms
scripts =
    alembic

[conf]
path = ${buildout:directory}/conf

[cancel_auth]
recipe = z3c.recipe.usercrontab
times = */10 * * * *
command = ${buildout:directory}/bin/cancel_auth_expired_carts ${conf:path}/ticketing.ini ${buildout:directory}/cancel_auth_expired_carts.conf

[sej_notification]
recipe = z3c.recipe.usercrontab
times = */10 * * * *
command = ${buildout:directory}/bin/sej_notification ${conf:path}/sej.ini 

[update_seat_status]
recipe = z3c.recipe.usercrontab
times = */5 * * * *
command = ${buildout:directory}/bin/update_seat_status ${conf:path}/ticketing.ini ${buildout:directory}/update_seat_status.conf

[send_sales_reports_daily]
recipe = z3c.recipe.usercrontab
times = 0 7 * * *
command = ${buildout:directory}/bin/send_sales_reports ${conf:path}/ticketing.ini ${buildout:directory}/send_sales_reports.conf Daily

[send_sales_reports_weekly]
recipe = z3c.recipe.usercrontab
times = 30 7 * * *
command = ${buildout:directory}/bin/send_sales_reports ${conf:path}/ticketing.ini ${buildout:directory}/send_sales_reports.conf Weekly

[rakuten_checkout_sales]
recipe = z3c.recipe.usercrontab
times = */15 * * * *
command = ${buildout:directory}/bin/rakuten_checkout_sales ${conf:path}/ticketing.ini ${buildout:directory}/rakuten_checkout_sales.conf

[multicheckout_cancel_auth]
recipe = z3c.recipe.usercrontab
times = 0 * * * *
command = ${buildout:directory}/bin/cancel_auth ${conf:path}/ticketing.ini 

[copy_seat_adjacency]
recipe = z3c.recipe.usercrontab
times = 20 * * * *
command = ${buildout:directory}/bin/copy_seat_adjacency ${conf:path}/ticketing.ini ${buildout:directory}/copy_seat_adjacency.conf
